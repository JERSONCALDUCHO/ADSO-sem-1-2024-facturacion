{% extends 'layout.html' %}

{% block contenido %}
    <h2>{{ titulo }}</h2>   
    <form action="/formulario_producto" method="post">
        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="codigo">Codigo</label>  
            <input type="text" class="form-control" id="codigo" name="codigo" {% if producto_almacenar %} value="{{ producto_almacenar.codigo }}" {% endif %} placeholder="Ejemplo: AAA000000" onblur="validarCodigo()"> 
            {% if errorCodigoProducto %}
            <span class="alert alert-danger" role="alert" id="errorCodigo"> {{ errorCodigoProducto }}</span>
            {% endif %}
          </div>
          <div class="form-group col-md-6">
            <label for="descripcion">Descripción</label>
            <input type="text" class="form-control" id="descripcion" name="descripcion" {% if producto_almacenar %} value="{{ producto_almacenar.descripcion }}" {% endif %} placeholder="Describa el producto (dato único)"> 
            {% if errorProducto %}
            <span class="alert alert-danger" role="alert" id="errorDescripcion"> {{ errorProducto }}</span>
            {% endif %}
          </div>
          <div class="form-group col-md-6">
            <label for="cantidad_inventario">Cantidad Inventario</label>
            <input type="number" class="form-control" id="cantidad_inventario" name="cantidad_inventario" {% if producto_almacenar %} value="{{ producto_almacenar.cantidad_inventario }}" {% endif %}> 
            <span class="alert alert-danger" role="alert" id="errorCantidadProducto" style="display: none;">Ingrese la cantidad del producto</span>
          </div>
          <div class="form-group col-md-6">
            <label for="precio_unitario">Precio Unitario</label>
            <input type="number" class="form-control" id="precio_unitario" name="precio_unitario" {% if producto_almacenar %} value="{{ producto_almacenar.precio_unitario }}" {% endif %}> 
            <span class="alert alert-danger" role="alert" id="errorPrecio" style="display: none;">Ingrese el precio del producto</span>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group col-md-4">
            <label for="unidad_medida">Unidad de Medida</label>
            <select id="unidad_medida" name="unidad_medida" class="form-control">
              <option selected>Por favor seleccione...</option>
              <option value="GRS">GRS</option>
              <option value="UND">UND</option>
            </select>
          </div>
          <div class="form-group col-md-4">
            <label for="categoria">Categoria</label>
            <select id="categoria" name="categoria" class="form-control">
              <option selected>Por favor seleccione...</option>
              {% for categoria in categorias %}
              <option value="{{categoria.id}}">{{categoria.nombre_categoria}}</option>
              {% endfor %}
            </select>
          </div>
        </div>
        <button type="submit" class="btn btn-primary">Guardar</button>
      </form>  
      <script type="text/javascript">
        function validarCodigo() {
          console.log("Inicio de la funcion")
          let campoCodigo = document.getElementById("codigo");
          let valorCodigo = campoCodigo.value;
          let errorCodigo = document.getElementById("errorCodigo");
          console.log("Valor codigo escrito: " + valorCodigo)
          var expresionregular = new RegExp("[A-Z]{3}[0-9]{1,}")
          if (expresionregular.test(valorCodigo)) {
            console.log("Cumple");
            errorCodigo.style.display = 'none';

          } else {
            console.log("No cumple");
            errorCodigo.style.display = 'block';
          }
        }

        function validarDescripcion() {
          let campoDescripcion = document.getElementById("descripcion");
          let valorDescripcion = campoDescripcion.value;
          let errorDescripcion = document.getElementById("errorDescripcion");
          console.log("Valor escrito: " + valorDescripcion)
          var expresionregular = new RegExp("[A-Z]{300}")
          if (expresionregular.test(valorDescripcion)) {
            console.log("Cumple");
            errorDescripcion.style.display = 'none';

          } else {
            console.log("No cumple");
            errorDescripcion.style.display = 'block';
          }
        }

        function validarCantidadProducto() {
          let campoCantidadProducto = document.getElementById("cantidad_inventario");
          let valorCantidadProducto = campoCantidadProducto.value;
          let errorCantidadProducto = document.getElementById("errorCantidadProducto");
          console.log("Valor escrito: " + valorCantidadProducto)
          var expresionregular = new RegExp("[0-9]{1,}")
          if (expresionregular.test(valorCantidadProducto)) {
            console.log("Cumple");
            errorCantidadProducto.style.display = 'none';

          } else {
            console.log("No cumple");
            errorCantidadProducto.style.display = 'block';
          }
        }

        function validarPrecio() {
          let campoPrecio = document.getElementById("precio_unitario");
          let valorPrecio = campoPrecio.value;
          let errorPrecio = document.getElementById("errorPrecio");
          console.log("Valor escrito: " + valorPrecio)
          var expresionregular = new RegExp("[0-9]{1,}")
          if (expresionregular.test(valorPrecio)) {
            console.log("Cumple");
            errorPrecio.style.display = 'none';

          } else {
            console.log("No cumple");
            errorPrecio.style.display = 'block';
          }
        }
      </script>
{% endblock contenido %}